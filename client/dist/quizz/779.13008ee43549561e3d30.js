(self.webpackChunkquizz=self.webpackChunkquizz||[]).push([[779],{4779:(t,e,n)=>{"use strict";n.r(e),n.d(e,{GameModule:()=>B});var i=n(8583),r=n(5806),s=n(4762),a=n(2340),c=n(639),o=n(7764),d=n(1239),l=n(1320);let p=(()=>{class t{constructor(){this.minutes="00",this.seconds="00"}setTimer(t){t?clearInterval(this.interval):this.interval=setInterval(()=>{this.seconds=this.incrTimer(this.seconds),parseInt(this.seconds)>=59&&(this.minutes=this.incrTimer(this.minutes),this.seconds="00")},1e3)}incrTimer(t){const e=parseInt(t)+1;return e<10?"0"+e:e.toString()}resetTimer(){this.minutes="00",this.seconds="00",this.setTimer(!0)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=c.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),g=(()=>{class t{constructor(t,e,n){this.gameParams=t,this.alert=e,this.timer=n,this.onTurnTry=0,this.turnTry=[],this.alreadyDiscovered=[],this.alreadyOpened=[],this.numberOftries=0,this.playerIndexTurn=0}addTurnTry(t){const{unique:e,id:n}=t;if(!(this.alreadyOpened.includes(e)||(this.alreadyOpened.push(e),this.onTurnTry+=1,this.turnTry.push(n),this.onTurnTry<2)))return this.numberOftries+=1,this.checkCombinaison()}checkCombinaison(){const[t,e]=this.turnTry,n=this.gameParams.players.length>1;return t===e?(this.alreadyDiscovered.push(t),n&&this.gameParams.addPointToPlayer(this.playerIndexTurn),this.alreadyDiscovered.length===this.gameParams.selectedDifficulty?(this.timer.setTimer(!0),"win"):void this.reset()):(n&&this.changePlayerTurn(),this.reset(),"close")}messageToPlayer(){this.alert.message=`Au tour de ${this.gameParams.players[this.playerIndexTurn].username} de jouer`,this.alert.switchAlert()}changePlayerTurn(){this.playerIndexTurn<this.gameParams.players.length&&this.playerIndexTurn++,this.playerIndexTurn===this.gameParams.players.length&&(this.playerIndexTurn=0)}reset(){this.onTurnTry=0,this.turnTry=[],this.alreadyOpened=[]}hardReset(){this.reset(),this.alreadyDiscovered=[],this.numberOftries=0,this.timer.resetTimer(),this.gameParams.players.forEach(t=>{t.totalPoints=0})}getNumberOfTries(){return this.numberOftries}}return t.\u0275fac=function(e){return new(e||t)(c.LFG(d.t),c.LFG(l.c),c.LFG(p))},t.\u0275prov=c.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var h=n(9362),m=n(3025),u=n(1597),f=n(1639);function y(t,e){1&t&&(c.TgZ(0,"div",3),c.Hsn(1),c.qZA()),2&t&&c.Q6J("@popIn",void 0)}function x(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",1),c.NdJ("click",function(e){return c.CHM(t),c.oxw().removeModal(e)}),c.YNc(1,y,2,1,"div",2),c.qZA()}if(2&t){const t=c.oxw();c.Q6J("ngStyle",t.style),c.xp6(1),c.Q6J("ngIf",t.isDisplayed)}}const P=["*"];let b=(()=>{class t{constructor(t,e){this.el=t,this.regPopService=e,this.closeOnClick=!0,this.opacity=0,this.style={},this.isDisplayed=!1}ngOnInit(){this.regPopService.getRegPopDisplay().subscribe(t=>{this.isDisplayed=t,t?(document.body.append(this.el.nativeElement),this.style={"background-color":`rgba(0, 0, 0, ${this.opacity})`}):this.el.nativeElement.remove()})}removeModal(t){this.closeOnClick&&this.regPopService.switchModal()}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(c.SBq),c.Y36(h.L))},t.\u0275cmp=c.Xpm({type:t,selectors:[["reg-pop"]],inputs:{closeOnClick:"closeOnClick",opacity:"opacity"},ngContentSelectors:P,decls:1,vars:1,consts:[["class","modal_all",3,"ngStyle","click",4,"ngIf"],[1,"modal_all",3,"ngStyle","click"],["class","modal_content","stopPropagation","",4,"ngIf"],["stopPropagation","",1,"modal_content"]],template:function(t,e){1&t&&(c.F$t(),c.YNc(0,x,2,2,"div",0)),2&t&&c.Q6J("ngIf",e.isDisplayed)},directives:[i.O5,i.PC,f._],styles:[".modal_all[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;overflow:hidden;z-index:10000}"],data:{animation:[u.Yr]}}),t})();var C=n(2481);function _(t,e){if(1&t&&(c.TgZ(0,"div",4),c.TgZ(1,"h2"),c._uU(2),c.qZA(),c.qZA()),2&t){const t=c.oxw();c.xp6(2),c.Oqu(t.draw?"Egalite":t.winner.username+" a gagn\xe9 !")}}function w(t,e){if(1&t&&(c.TgZ(0,"div",4),c.TgZ(1,"h2"),c._uU(2),c.qZA(),c.TgZ(3,"h2"),c._uU(4),c.qZA(),c.qZA()),2&t){const t=c.oxw();c.xp6(2),c.hij("Tu as gagn\xe9 ! en ",t.game.numberOftries," coups !"),c.xp6(2),c.AsE(" Tu as mis ","00"===t.timer.minutes?"":t.timer.minutes+"minutes et"," ",t.timer.seconds," secondes ")}}let O=(()=>{class t{constructor(t,e,n,i,r){this.game=t,this.regPopService=e,this.gameParams=n,this.router=i,this.timer=r,this.winner={},this.draw=!1,this.restartChange=new c.vpe,this.multi=!1}ngOnInit(){this.multi=this.gameParams.players.length>1}restart(){this.regPopService.switchModal(),this.restartChange.emit()}restartAndChangeParams(){this.regPopService.switchModal(),setTimeout(()=>{this.gameParams.resetScore(),this.router.navigate(["/setup"])})}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(g),c.Y36(h.L),c.Y36(d.t),c.Y36(r.F0),c.Y36(p))},t.\u0275cmp=c.Xpm({type:t,selectors:[["win-box"]],inputs:{winner:"winner",draw:"draw"},outputs:{restartChange:"restartChange"},decls:6,vars:5,consts:[[1,"winbox"],["class","winbox_text",4,"ngIf"],[1,"winbox_buttons"],[3,"label","click"],[1,"winbox_text"]],template:function(t,e){1&t&&(c.TgZ(0,"div",0),c.YNc(1,_,3,1,"div",1),c.YNc(2,w,5,3,"div",1),c.TgZ(3,"div",2),c.TgZ(4,"reg-button",3),c.NdJ("click",function(){return e.restart()}),c.qZA(),c.TgZ(5,"reg-button",3),c.NdJ("click",function(){return e.restartAndChangeParams()}),c.qZA(),c.qZA(),c.qZA()),2&t&&(c.Q6J("@popIn",void 0),c.xp6(1),c.Q6J("ngIf",e.multi&&e.winner),c.xp6(1),c.Q6J("ngIf",!e.multi),c.xp6(2),c.Q6J("label","Rejouer"),c.xp6(1),c.Q6J("label","Parametres"))},directives:[i.O5,C.m],styles:["[_ngcontent-%COMP%]:root{--game-size:400px}@media screen and (max-width: 800px){[_ngcontent-%COMP%]:root{--game-size:100%}}.winbox[_ngcontent-%COMP%]{background-color:#ffe66d;box-shadow:2px 2px 0 0 #47bdb5;padding:10px;border-radius:5px;justify-content:space-between;align-items:center;width:100%}.winbox[_ngcontent-%COMP%], .winbox_text[_ngcontent-%COMP%]{display:flex;flex-direction:column}.winbox_text[_ngcontent-%COMP%]{justify-content:center;margin:10px}.winbox[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#4ecdc4}.winbox_buttons[_ngcontent-%COMP%]{display:flex;width:90%;justify-content:space-between}"],data:{animation:[u.Yr]}}),t})(),v=(()=>{class t{constructor(t){this.timer=t}ngOnInit(){}ngOnDestroy(){this.timer.resetTimer()}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(p))},t.\u0275cmp=c.Xpm({type:t,selectors:[["timer"]],decls:9,vars:2,consts:[[1,"timer"],[1,"timer_digit"]],template:function(t,e){1&t&&(c.TgZ(0,"div",0),c.TgZ(1,"div",1),c.TgZ(2,"p"),c._uU(3),c.qZA(),c.qZA(),c.TgZ(4,"p"),c._uU(5,":"),c.qZA(),c.TgZ(6,"div",1),c.TgZ(7,"p"),c._uU(8),c.qZA(),c.qZA(),c.qZA()),2&t&&(c.xp6(3),c.Oqu(e.timer.minutes),c.xp6(5),c.Oqu(e.timer.seconds))},styles:["[_ngcontent-%COMP%]:root{--game-size:400px}@media screen and (max-width: 800px){[_ngcontent-%COMP%]:root{--game-size:100%}}.timer[_ngcontent-%COMP%]{display:flex;font-size:medium;font-weight:700;align-items:center;background-color:#4ecdc4;padding:10px;border-radius:5px;box-shadow:2px 2px 0 0 #47bdb5}.timer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 5px}.timer_digit[_ngcontent-%COMP%]{border:3px solid #47bdb5;background-color:#4bc0b8;border-radius:5px;padding:5px}"]}),t})();const T=function(t){return{transform:t}};function Z(t,e){if(1&t){const t=c.EpF();c.ynx(0),c.TgZ(1,"div",2),c.NdJ("click",function(){return c.CHM(t),c.oxw().onClick()}),c.TgZ(2,"div",3),c._UZ(3,"div",4),c._UZ(4,"div",5),c.qZA(),c.qZA(),c.BQk()}if(2&t){const t=c.oxw();c.xp6(2),c.Q6J("ngStyle",c.VKq(3,T,t.card.displayed?"rotateY(180deg)":"")),c.xp6(1),c.Q6J("ngStyle",t.back),c.xp6(1),c.Q6J("ngStyle",t.backroungImg)}}let k=(()=>{class t{constructor(){this.cardBack="",this.displayCard=new c.vpe,this.backroungImg={},this.rotation={},this.back={}}ngOnInit(){this.card&&(this.backroungImg={"background-image":`url('${this.card.download_url||a.N.proxy+this.card.path}')`}),this.cardBack&&(this.back={"background-image":`url('${this.cardBack}')`})}onClick(){this.card&&this.displayCard.emit({unique:this.card.uniqueId,id:this.card.id})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Xpm({type:t,selectors:[["card"]],inputs:{card:"card",cardBack:"cardBack"},outputs:{displayCard:"displayCard"},decls:2,vars:1,consts:[[1,"card"],[4,"ngIf"],[1,"card_container",3,"click"],[1,"flip-card-inner",3,"ngStyle"],[1,"flip-card-front",3,"ngStyle"],[1,"flip-card-back",3,"ngStyle"]],template:function(t,e){1&t&&(c.TgZ(0,"div",0),c.YNc(1,Z,5,5,"ng-container",1),c.qZA()),2&t&&(c.xp6(1),c.Q6J("ngIf",e.card))},directives:[i.O5,i.PC],styles:["[_ngcontent-%COMP%]:root{--game-size:400px}@media screen and (max-width: 800px){[_ngcontent-%COMP%]:root{--game-size:100%}}.card_container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:80px;height:80px;cursor:pointer;perspective:1000px;margin:5px 0}.card[_ngcontent-%COMP%]   .flip-card-inner[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;text-align:center;border-radius:5px;transition:1s;transform-style:preserve-3d}.card[_ngcontent-%COMP%]   .flip-card-inner[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.card[_ngcontent-%COMP%]   .flip-card-back[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   .flip-card-front[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;-webkit-backface-visibility:hidden;backface-visibility:hidden}.card[_ngcontent-%COMP%]   .flip-card-front[_ngcontent-%COMP%]{color:#000;background-color:#47bdb5}.card[_ngcontent-%COMP%]   .flip-card-back[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   .flip-card-front[_ngcontent-%COMP%]{border-radius:15px;background-size:cover;background-position:50%}.card[_ngcontent-%COMP%]   .flip-card-back[_ngcontent-%COMP%]{color:#fff;transform:rotateY(180deg)}"]}),t})();const M=function(t){return{playerInfo_myTurn:t}};function I(t,e){if(1&t&&(c.ynx(0),c.TgZ(1,"div",2),c.TgZ(2,"p"),c._uU(3),c.qZA(),c.TgZ(4,"h3"),c._uU(5),c.qZA(),c.qZA(),c.BQk()),2&t){const t=c.oxw();c.xp6(1),c.Q6J("ngClass",c.VKq(3,M,t.game.playerIndexTurn===t.index)),c.xp6(2),c.Oqu(t.player.totalPoints),c.xp6(2),c.hij(" ",t.player.username," ")}}let q=(()=>{class t{constructor(t){this.game=t,this.index=0}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(g))},t.\u0275cmp=c.Xpm({type:t,selectors:[["player-info"]],inputs:{player:"player",index:"index"},decls:2,vars:1,consts:[[1,"playerInfo"],[4,"ngIf"],[1,"playerInfo_container",3,"ngClass"]],template:function(t,e){1&t&&(c.TgZ(0,"div",0),c.YNc(1,I,6,5,"ng-container",1),c.qZA()),2&t&&(c.xp6(1),c.Q6J("ngIf",e.player))},directives:[i.O5,i.mk],styles:["[_ngcontent-%COMP%]:root{--game-size:400px}@media screen and (max-width: 800px){[_ngcontent-%COMP%]:root{--game-size:100%}}.playerInfo_container[_ngcontent-%COMP%]{display:flex;align-items:center;background-color:#4bc0b8;padding:5px;border-radius:5px;box-shadow:2px 2px 0 0 #47bdb5;margin:0 10px;transition:.4s}.playerInfo_container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-right:5px;font-weight:700}.playerInfo[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:small}.playerInfo_myTurn[_ngcontent-%COMP%]{background-color:#ffe66d;transform:scale(1.1)}.playerInfo_myTurn[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{color:#4ecdc4!important}"]}),t})();function A(t,e){1&t&&(c.TgZ(0,"div"),c._UZ(1,"timer"),c.qZA())}function J(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"card",7),c.NdJ("displayCard",function(e){return c.CHM(t),c.oxw().displayCard(e)}),c.qZA()}if(2&t){const t=e.$implicit,n=c.oxw();c.Q6J("card",t)("cardBack",n.cardBack)}}function Y(t,e){if(1&t&&c._UZ(0,"player-info",10),2&t){const t=e.index;c.Q6J("player",e.$implicit)("index",t)}}function S(t,e){if(1&t&&(c.TgZ(0,"div",8),c.YNc(1,Y,1,2,"player-info",9),c.qZA()),2&t){const t=c.oxw();c.xp6(1),c.Q6J("ngForOf",t.players)}}const L=[{path:"",component:(()=>{class t{constructor(t,e,n,i,r,s){this.request=t,this.game=e,this.gameParams=n,this.regPopService=i,this.timer=r,this.bigSpinner=s,this.cardsList=[],this.isFlipping=!1,this.players=[],this.multi=!1,this.themeName="",this.cardBack="",this.winner={},this.draw=!1}ngOnInit(){this.bigSpinner.show("cardsList"),this.startGame(),this.players=this.gameParams.players,this.multi=this.gameParams.players.length>1,this.themeName=this.gameParams.selectedTheme.name}startGame(){this.timer.setTimer(!1);const t=this.gameParams.selectedTheme._id,e=this.gameParams.selectedDifficulty;if(t){this.request.getThemePics(e,t).subscribe({next:t=>{this.cardsList=t,this.bigSpinner.hide("cardsList")}});const n=this.gameParams.selectedTheme.images.filter(t=>"cardBack"===t.type);this.cardBack=a.N.proxy+n[0].path}else this.request.getDefaultTheme(e).subscribe({next:t=>{this.cardsList=t,this.bigSpinner.hide("cardsList")}})}reset(){this.game.hardReset(),this.closeCards(),this.startGame(),this.winner={},this.draw=!1}closeCards(){this.cardsList.forEach(t=>{t.displayed=!!this.game.alreadyDiscovered.includes(t.id)})}openCard(t){this.cardsList.forEach(e=>{e.uniqueId===t&&(e.displayed=!0)})}displayCard(t){return(0,s.mG)(this,void 0,void 0,function*(){if(this.isFlipping)return;this.openCard(t.unique);const e=this.game.addTurnTry(t);"win"===e&&(this.saveGame(),this.interval=setTimeout(()=>{this.setWinner(),this.regPopService.switchModal()},800)),"close"===e&&(this.isFlipping=!0,yield new Promise((t,e)=>{this.interval=setTimeout(()=>{t(this.closeCards())},1e3)}),this.isFlipping=!1)})}setWinner(){const t=this.gameParams.players.map(t=>{const{totalPoints:e}=t;return e});this.draw=t.every(e=>e===t[0]);const e=this.gameParams.players.reduce((t,e)=>t.totalPoints>e.totalPoints?t:e);this.winner=e}saveGame(){const{players:t,selectedDifficultyString:e}=this.gameParams,n=t.length>1?"multi":"solo",i="multi"===n,{minutes:r,seconds:s}=this.timer,a={type:n,try:this.game.numberOftries,userScore:t[0].totalPoints,opponent:i?t[1].username:"",opponentScore:i?t[1].totalPoints:0,time:`${r}:${s}`,difficulty:e,date:new Date};this.request.post("games",a).subscribe()}ngOnDestroy(){clearTimeout(this.interval),this.timer.resetTimer(),this.game.hardReset()}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(o.s),c.Y36(g),c.Y36(d.t),c.Y36(h.L),c.Y36(p),c.Y36(m.L))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-cardslist"]],decls:7,vars:6,consts:[[1,"cardList"],[4,"ngIf"],[1,"cardList_cardWrapper"],[3,"card","cardBack","displayCard",4,"ngFor","ngForOf"],["class","cardList_players",4,"ngIf"],[3,"closeOnClick"],[3,"winner","draw","restartChange"],[3,"card","cardBack","displayCard"],[1,"cardList_players"],[3,"player","index",4,"ngFor","ngForOf"],[3,"player","index"]],template:function(t,e){1&t&&(c.TgZ(0,"div",0),c.YNc(1,A,2,0,"div",1),c.TgZ(2,"div",2),c.YNc(3,J,1,2,"card",3),c.qZA(),c.YNc(4,S,2,1,"div",4),c.qZA(),c.TgZ(5,"reg-pop",5),c.TgZ(6,"win-box",6),c.NdJ("restartChange",function(){return e.reset()}),c.qZA(),c.qZA()),2&t&&(c.xp6(1),c.Q6J("ngIf",!e.multi),c.xp6(2),c.Q6J("ngForOf",e.cardsList),c.xp6(1),c.Q6J("ngIf",e.multi),c.xp6(1),c.Q6J("closeOnClick",!1),c.xp6(1),c.Q6J("winner",e.winner)("draw",e.draw))},directives:[i.O5,i.sg,b,O,v,k,q],styles:["[_ngcontent-%COMP%]:root{--game-size:400px}@media screen and (max-width: 800px){[_ngcontent-%COMP%]:root{--game-size:100%}}.cardList[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%}.cardList_cardWrapper[_ngcontent-%COMP%]{margin-top:10px;flex-wrap:wrap}.cardList_cardWrapper[_ngcontent-%COMP%], .cardList_players[_ngcontent-%COMP%]{width:90%;display:flex;justify-content:space-between}.cardList_players[_ngcontent-%COMP%]{align-items:center}"]}),t})()}];let Q=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[r.Bz.forChild(L)],r.Bz]}),t})();var z=n(6684),N=n(665);let B=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[i.ez,Q,z.m,N.u5]]}),t})()}}]);